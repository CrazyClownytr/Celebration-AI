import{DrawingUtils as I,FilesetResolver as E,HandLandmarker as h}from"https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.18";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))f(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const m of n.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&f(m)}).observe(document,{childList:!0,subtree:!0});function o(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function f(t){if(t.ep)return;t.ep=!0;const n=o(t);fetch(t.href,n)}})();const B=document.getElementById("webcamButton"),L=document.getElementById("poseLabel"),M=document.getElementById("confidenceScore"),i=document.getElementById("webcam"),r=document.getElementById("output_canvas"),b=r.getContext("2d"),p=new I(b);let w,k=!1,d;const c=document.getElementById("howToPlayModal"),O=document.getElementById("howToPlayBtn"),F=document.querySelector(".close"),C=document.getElementById("startQuizModal");document.querySelector(".close-start");document.getElementById("startQuizBtn");const g=document.getElementById("footballerImg"),u=document.getElementById("playerImage"),s=[{name:"pedri",img:"./img/pedri.jpeg"},{name:"messi",img:"./img/messi.jpg"},{name:"dybala",img:"./img/dybala.jpg"},{name:"gyokeres",img:"./img/gyokeres.png"},{name:"depay",img:"./img/depay.png"},{name:"ozil",img:"./img/ozil.jpg"}];let l=null,y;function N(){ml5.setBackend("webgl"),y=ml5.neuralNetwork({task:"classification",debug:!0});const e={model:"./model/model.json",metadata:"./model/model_meta.json",weights:"./model/model.weights.bin"};y.load(e,P())}O.onclick=()=>{c.style.display="block"};F.onclick=()=>{c.style.display="none"};window.onclick=e=>{e.target===c&&(c.style.display="none")};const P=async()=>{console.log("neural network model is loaded");const e=await E.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.0/wasm");w=await h.createFromOptions(e,{baseOptions:{modelAssetPath:"https://storage.googleapis.com/mediapipe-models/hand_landmarker/hand_landmarker/float16/1/hand_landmarker.task",delegate:"GPU"},runningMode:"VIDEO",numHands:2}),console.log("model loaded, you can start webcam"),B.addEventListener("click",a=>H())};async function H(){k=!0;try{const e=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});i.srcObject=e,i.addEventListener("loadeddata",()=>{r.style.width=i.videoWidth,r.style.height=i.videoHeight,r.width=i.videoWidth,r.height=i.videoHeight,document.querySelector(".videoView").style.height=i.videoHeight+"px",v(),C.style.display="none",l=s[Math.floor(Math.random()*s.length)],g.src=l.img,u.style.display="block"})}catch(e){console.error("Error accessing webcam:",e)}}async function v(){d=await w.detectForVideo(i,performance.now()),b.clearRect(0,0,r.width,r.height);for(let e of d.landmarks)p.drawConnectors(e,h.HAND_CONNECTIONS,{color:"#00FF00",lineWidth:5}),p.drawLandmarks(e,{radius:4,color:"#FF0000",lineWidth:2});k&&window.requestAnimationFrame(v)}function j(){if(d&&d.landmarks.length>0){let e=d.landmarks[0],a=[];for(let o of e)a.push(o.x,o.y,o.z);console.log("Hand coordinates:",a),a.length===63?y.classify(a,o=>{console.log(o),console.log(`i think this pose is a ${o[0].label}`),console.log(o[0].label),console.log(`i am ${o[0].confidence.toFixed(2)*100}% sure`),L.innerText=`Pose: ${o[0].label}`,M.innerText=`Confidence: ${o[0].confidence.toFixed(2)*100}%`,l&&o[0].label.toLowerCase()===l.name.toLowerCase()&&o[0].confidence>.5?(alert(`Juist! Dat is de ${l.name} celebration! ðŸŽ‰`),l=s[Math.floor(Math.random()*s.length)],g.src=l.img,u.style.display="block"):(alert(`fout! Dat is de ${l.name} celebration! âŒ`),l=s[Math.floor(Math.random()*s.length)],g.src=l.img,u.style.display="block")}):console.error("Invalid input length:",a.length)}}N();setInterval(()=>{j()},2e3);
